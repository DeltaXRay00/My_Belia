<%= user_topbar(assigns) %>

<section class="program-detail-hero">
	<div class="container">
		<div class="breadcrumb">
			<a href="/senarai_kursus">← Kembali ke Senarai Kursus</a>
		</div>
	</div>
</section>

<section class="program-detail-section">
	<div class="container">
		<div class="program-detail-card">
			<div class="program-detail-header">
				<div class="program-detail-image">
					<img src={@course.image_data} alt={@course.name} />
				</div>
			</div>
			<div class="program-detail-content">
				<h1 class="program-detail-title"><%= @course.name %></h1>
				<div class="program-detail-description">
					<div class="description-content">
						<%= raw(@course.description) %>
					</div>
				</div>
				<div class="program-detail-info">
					<div class="info-grid">
						<div class="info-item">
							<div class="info-label">Tarikh Mula</div>
							<div class="info-value"><%= Date.to_string(@course.start_date) %></div>
						</div>
						<div class="info-item">
							<div class="info-label">Tarikh Tamat</div>
							<div class="info-value"><%= Date.to_string(@course.end_date) %></div>
						</div>
						<div class="info-item">
							<div class="info-label">Waktu Mula</div>
							<div class="info-value"><%= Time.to_string(@course.start_time) %></div>
						</div>
						<div class="info-item">
							<div class="info-label">Waktu Tamat</div>
							<div class="info-value"><%= Time.to_string(@course.end_time) %></div>
						</div>
					</div>
				</div>
				
				<!-- Application Status Section -->
				<%= if @current_user != nil do %>
					<div class="application-status-section">
						<%= if @has_applied do %>
							<div class="application-status applied">
								<div class="status-icon">✅</div>
								<div class="status-text">
									<h3>Permohonan Dihantar</h3>
									<p>Anda telah memohon untuk kursus ini. Status permohonan anda akan dikemas kini.</p>
								</div>
							</div>
						<% else %>
							<%= if @can_apply do %>
								<div class="application-status eligible">
									<div class="status-icon">📋</div>
									<div class="status-text">
										<h3>Layak Memohon</h3>
										<p>Anda layak untuk memohon kursus ini. Pastikan semua maklumat anda lengkap.</p>
									</div>
								</div>
							<% else %>
								<div class="application-status not-eligible">
									<div class="status-icon">⚠️</div>
									<div class="status-text">
										<h3>Tidak Layak Memohon</h3>
										<p>Untuk memohon kursus ini, anda perlu:</p>
										<ul>
											<li>Muat naik dokumen sokongan di halaman <a href="/dokumen_sokongan">Dokumen Sokongan</a></li>
											<li>Lengkapkan maklumat pendidikan di halaman <a href="/profil_pengguna">Profil Pengguna</a></li>
										</ul>
									</div>
								</div>
							<% end %>
						<% end %>
					</div>
				<% else %>
					<div class="application-status-section">
						<div class="application-status not-logged-in">
							<div class="status-icon">🔒</div>
							<div class="status-text">
								<h3>Log Masuk Diperlukan</h3>
								<p>Anda perlu <a href="/log-masuk">log masuk</a> untuk memohon kursus ini.</p>
							</div>
						</div>
					</div>
				<% end %>
				
				<div class="program-detail-actions">
					<%= if @current_user != nil and @can_apply do %>
						<button class="apply-now-btn" phx-click="apply-for-course">Mohon Sekarang</button>
					<% else %>
						<button class="apply-now-btn disabled" disabled>Mohon Sekarang</button>
					<% end %>
					<a href="/senarai_kursus" class="back-to-list-btn">Kembali ke Senarai</a>
				</div>
			</div>
		</div>
	</div>
</section>

<%= user_footer(assigns) %> 